# shell 脚本的构成

shell 脚本只有以下内容元素：

- shebang
- 命令
- keyword（例如 if、function）
- 变量
- 符号
  - 文本符号
  - 分隔符（例如空格）
- 字符串
- 注释

<br>

# shell 命令的基本概念

命令的基本单位是“行”

一行命令的基本结构是：command + [options]

第一个单词，一定是命令

命令只有以下四种类型：

- 可执行程序
  - 直接指向某个文件：绝对路径 / 相对路径
  - 一个单词，系统自动添加 path 后组成绝对路径
- shell 内置命令（builtins）
- shell 函数（function）
- alias

<br>

# shell 脚本的解析机制

shell 脚本不过是命令的集合

默认情况下，解释器将文本划分为行，每一行视为一个命令，从上到下依次执行

每行命令又被分割为一个个单词，除了第一个单词被视为命令，其他单词均视为字符串

凡是能够在命令行中运行的命令，都可以写到 shell 脚本中

此外，shell 脚本还提供了一些基本的程序语言能力，包括：

- 字符展开（含变量）
- 流程控制
- 函数（含局部变量）
- 数组

<br>

# 字符展开

默认情况下，shell 会将命令以外的字符，一律解析为字符串。只有当遇到特殊符号或关键字，才会改用特定的解析规则

遇到特殊符号时，先解析或计算出表达式的结果，再代入原脚本，这个过程称为展开（Expansion）

### 路径名展开

只要单词内包含通配符，则展开为一组文件名

与路径名展开相关的通配符：

- `*` 任意数量的任意字符
- `?` 任意一个字符（不能是零个）
- `[characters]` 字符集中的任意一个字符（不能是零个）
- `[!characters]` 不属于字符集中的任意一个字符（不能是零个）
- `[:class:]` 特定字符集中的任意一个字符（不能是零个）

> 如果路径展开失败，表达式将被视为字符串

> ~ 自动展开为家目录路径


### 算数表达式展开

`$((expression))`


### 花括号展开

用于生成多个字符串

- 数字序列：`{1..9}`
- 字母序列：`{a..f}`
- 字符组合：`{1,a,2,b}`

支持嵌套


### 变量展开

又称参数展开，叫变量展开更贴切

只要遇到 `$` 符号就进行变量展开

变量分为内置变量（例如：`$PATH`）和自定义变量

查看所有内置变量：`printenv | less`


### 命令代换

`$(command)`

> 另一种语法是反引号 ``


### 避免展开

为了避免自动展开导致非预期的结果，
