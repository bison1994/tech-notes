# 虚拟地址

- 由操作系统提供虚拟地址到物理地址的映射，由 CPU 中的 MMU 单元（内存管理单元）提供虚拟地址到物理地址的翻译

# 分段

地址（段号 + 偏移） => 段表 => 段的物理基址 + 偏移 => 实际的物理地址

内存的分段是和程序的分段保持一致的，单个段是连续的，多个段是离散的，段的大小不固定，会导致内存分配出现外部碎片，空间利用率低


# 分页

地址（页号 + 偏移） => 页表 => 页的物理基址 + 偏移 => 实际的物理地址

将内存细分为固定大小（常见的大小是 4KB）的单元：页，每个程序离散的映射到多个页。由于程序大小不一定是页的整数倍，所以会出现内部碎片

一个页是 4KB，由于内存的最小单元是字节，即一个页有 4096 个字节，因此一个虚拟地址只需其中的 12 位即可标识偏移量，其他的位则用于寻找页

页表是按照多个层级组织的，因为理论上每一个虚拟地址都需要映射，如果页表只有单个层级，则 64 位地址，除最后 12 位，需要 2^52 个页表项，每个页表项存一个物理页的基址，总大小为 2^52 * 64 = 2^58 个 bit = 2^55 个字节 = 2^45 KB = 2^35 MB = 2^25 GB


# 换页

虚拟页与物理页的映射是按需建立的，操作系统通过【缺页异常】感知需求的发生，然后实际分配物理内存。当物理内存不够时，通过【换页】，解除一部分页所占用的物理内存并重新分配给当前需要的虚拟页。这种机制使得计算机能够利用的内存超出了物理容量的限制
