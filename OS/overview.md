# 操作系统核心知识

> 操作系统两大功能：一是任务管理，二是资源管理（资源只有两类，内存 & I/O）
> 文件是对 I/O 设备的抽象，虚存是对内存+文件的抽象，任务是对 CPU+虚存的抽象

- 1、任务管理
  - 任务抽象：进程、线程
  - 任务调度：机制、策略
  - 任务通信（IPC，inter-process communication）
    - 同系统
      - 以单向传递数据为目的
        - **Pipe 管道**
        - **Signal 信号**
      - 以相互传递数据为目的
        - **File 文件**
        - **Shared memory 共享内存**
        - **Message queue 消息队列**
      - 以同步为目的
        - **Semaphore 信号量**
    - 跨系统
      - **Socket 套接字**
  - 任务并发
    - 互斥（原子性）
    - 同步
- 2、内存管理
- 3、I/O 与文件
  - 磁盘：RAID（Redundant Array of Independent Disks）
- 4、其他主题


### 任务并发

核心两个问题： 
  - 对共享变量的写入相互覆盖 -> 需要某种**互斥**机制，将共享变量变为非共享资源，确保并发环境下，每个线程的执行序列都具有排他性、**原子性**、对 CPU 的独占权
    - 互斥机制
      - 硬件提供的互斥
        - 禁用中断。因为写入相互覆盖的原因是指令因中断导致执行顺序出现交叉，所以禁用中断即可。问题是执行效率降低、不适用于多处理器
        - 原子指令，类似线程安全方法。问题是可能导致死锁和饥饿
      - 操作系统或编程语言提供的互斥
        - 信号量
        - 条件变量
      - 应用代码自己实现互斥
    - 忙等待（busy waiting）与自旋等待（spin waiting）：在互斥约束下，如果临界区已经被占用（资源已被排他性占用），那么代码只能循环检测资源何时被释放
  - 对非共享资源的竞争冲突 -> **死锁**和**饥饿**
    - 死锁：基本模式是两个进程同时在等待两个资源的使用权，而这两个资源分别被两个进程持有且不会被主动释放，操作系统无法执行资源分配，陷入死局
    - 饥饿：部分进程持续占用资源，导致其他进程永远无法分配到资源

